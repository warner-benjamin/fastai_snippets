<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Automatic progressive resizing of images during training">

<title>fastxtend - Progressive Resizing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<meta property="og:title" content="fastxtend - Progressive Resizing">
<meta property="og:description" content="Automatic progressive resizing of images during training">
<meta property="og:image" content="https://fastxtend.benjaminwarner.dev/images/progressive_resizing.png">
<meta property="og:site-name" content="fastxtend">
<meta property="og:image:height" content="383">
<meta property="og:image:width" content="841">
<meta name="twitter:title" content="fastxtend - Progressive Resizing">
<meta name="twitter:description" content="Automatic progressive resizing of images during training">
<meta name="twitter:image" content="https://fastxtend.benjaminwarner.dev/images/progressive_resizing.png">
<meta name="twitter:image-height" content="383">
<meta name="twitter:image-width" content="841">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">fastxtend</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://benjaminwarner.dev" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resources" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Resources</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-resources">    
        <li>
    <a class="dropdown-item" href="https://docs.fast.ai" rel="" target=""><i class="bi bi-link" role="img">
</i> 
 <span class="dropdown-text">fast.ai</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://fastcore.fast.ai" rel="" target=""><i class="bi bi-link" role="img">
</i> 
 <span class="dropdown-text">fastcore</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://nbdev.fast.ai" rel="" target=""><i class="bi bi-link" role="img">
</i> 
 <span class="dropdown-text">nbdev</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/warner-benjamin/fastxtend/issues" rel="" target=""><i class="bi bi-bug" role="img">
</i> 
 <span class="dropdown-text">Report an Issue</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/warner-benjamin/fastxtend/" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/benjamin_warner" rel="" target=""><i class="bi bi-twitter" role="img" aria-label="Twitter">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./callback.overview.html">Callbacks</a></li><li class="breadcrumb-item"><a href="./callback.progresize.html">Progressive Resizing</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">fastxtend</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Callbacks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.channelslast.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Channels Last</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.cutmixup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CutMixUp &amp; Friends</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.ema.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exponential Moving Average</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.gradaccum.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gradient Accumulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.lr_finder.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learning Rate Finder</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.amp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed Precision</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.profiler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Profiler Callbacks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.progresize.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Progressive Resizing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.compiler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PyTorch Compile</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.tracker.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tracking Callbacks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.utils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Callback Utilities</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">FFCV [beta]</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ffcv.tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ffcv.fields.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fields</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ffcv.loader.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Loader</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ffcv.operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Operations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ffcv.transforms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transforms</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ffcv.writer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Writer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ffcv.utils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Utilities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ffcv.inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inference</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Losses</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./losses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Loss Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiloss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MultiLoss</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./metrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metrics Extended</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedulers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedulers</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.transforms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Splitters</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Optimizers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optimizer.fused.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fused fastai Optimizers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optimizer.eightbit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8-Bit Optimizers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optimizer.adan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Adan Optimizer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optimizer.lion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lion Optimizer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optimizer.sophia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sophia Optimizer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optimizer.stableadam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">StableAdam Optimizer</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Vision</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">Augmentations</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vision.augment.batch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Additional Batch Augmentations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vision.augment.itemtensor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tensor Item Transforms</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vision.data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vision Data</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
 <span class="menu-text">Models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vision.models.attention_modules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Attention Modules</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vision.models.pooling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pooling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vision.models.xresnet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">XResNet Extended</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text">Text</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./text.huggingface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hugging Face</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text">Audio</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./audio.01_core.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Core</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./audio.02_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./audio.03_augment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Augmentations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./audio.04_learner.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learner</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./audio.05_mixup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MixUp &amp; Friends</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
 <span class="menu-text">Utils</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transform</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./utils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Utility</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#increasemode" id="toc-increasemode" class="nav-link active" data-scroll-target="#increasemode">IncreaseMode</a></li>
  <li><a href="#progressiveresize" id="toc-progressiveresize" class="nav-link" data-scroll-target="#progressiveresize">ProgressiveResize</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a>
  <ul>
  <li><a href="#progressive-resizing" id="toc-progressive-resizing" class="nav-link" data-scroll-target="#progressive-resizing">Progressive Resizing</a>
  <ul class="collapse">
  <li><a href="#batch-resizing" id="toc-batch-resizing" class="nav-link" data-scroll-target="#batch-resizing">Batch Resizing</a></li>
  <li><a href="#epoch-resizing" id="toc-epoch-resizing" class="nav-link" data-scroll-target="#epoch-resizing">Epoch Resizing</a></li>
  </ul></li>
  <li><a href="#normal-training" id="toc-normal-training" class="nav-link" data-scroll-target="#normal-training">Normal Training</a></li>
  <li><a href="#progressive-resizing-with-normalized-compute-budget" id="toc-progressive-resizing-with-normalized-compute-budget" class="nav-link" data-scroll-target="#progressive-resizing-with-normalized-compute-budget">Progressive Resizing with Normalized Compute Budget</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/warner-benjamin/fastxtend/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Progressive Resizing</h1>
</div>

<div>
  <div class="description">
    Automatic progressive resizing of images during training
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>
<script src="https://static.cloudflareinsights.com/beacon.min.js?token=62f27bdcb8964407a52676798db9edfa" defer=""></script>
<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<p><a href="https://fastxtend.benjaminwarner.dev/callback.progresize.html#progressiveresize"><code>ProgressiveResize</code></a> is inspired by MosaicML’s <a href="https://docs.mosaicml.com/en/stable/method_cards/progressive_resizing.html">Progressive Resizing algorithm for Composer</a> which in turn was inspired by <a href="https://github.com/fastai/fastbook/blob/780b76bef3127ce5b64f8230fce60e915a7e0735/07_sizing_and_tta.ipynb">fastai’s</a> manual progressive resizing.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/progressive_resizing.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">progressive resizing illustrated</figcaption>
</figure>
</div>
<p>Progressive Resizing decreases model training time by training on smaller images then gradually increasing to the full image size. This allows training on more samples for the same compute budget, often leading to higher performance then training on full sized images.</p>
<hr>
<p><a href="https://github.com/warner-benjamin/fastxtend/blob/main/fastxtend/callback/progresize.py#L61" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="increasemode" class="level3">
<h3 class="anchored" data-anchor-id="increasemode">IncreaseMode</h3>
<blockquote class="blockquote">
<pre><code> IncreaseMode (value, names=None, module=None, qualname=None, type=None,
               start=1)</code></pre>
</blockquote>
<p>Increase mode for <a href="https://fastxtend.benjaminwarner.dev/callback.progresize.html#progressiveresize"><code>ProgressiveResize</code></a></p>
<hr>
<p><a href="https://github.com/warner-benjamin/fastxtend/blob/main/fastxtend/callback/progresize.py#L67" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="progressiveresize" class="level3">
<h3 class="anchored" data-anchor-id="progressiveresize">ProgressiveResize</h3>
<blockquote class="blockquote">
<pre><code> ProgressiveResize (initial_size:float|tuple[int,int]=0.5,
                    start:Numeric=0.5, finish:Numeric=0.75,
                    increase_by:int=4,
                    increase_mode:IncreaseMode=&lt;IncreaseMode.Batch:
                    'batch'&gt;, resize_mode:str='bilinear',
                    resize_valid:bool=True,
                    final_size:tuple[int,int]|None=None,
                    add_resize:bool=False, resize_targ:bool=False,
                    preallocate_bs:int|None=None, preallocate:bool=True,
                    empty_cache:bool=False, verbose:bool=True)</code></pre>
</blockquote>
<p>Progressively increase the size of input images during training. Starting from <code>initial_size</code> and ending at the valid image size or <code>final_size</code>.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>initial_size</td>
<td>float | tuple[int, int]</td>
<td>0.5</td>
<td>Staring size to increase from. Image shape must be square</td>
</tr>
<tr class="even">
<td>start</td>
<td>Numeric</td>
<td>0.5</td>
<td>Earliest upsizing epoch in percent of training time or epoch (index 0)</td>
</tr>
<tr class="odd">
<td>finish</td>
<td>Numeric</td>
<td>0.75</td>
<td>Last upsizing epoch in percent of training time or epoch (index 0)</td>
</tr>
<tr class="even">
<td>increase_by</td>
<td>int</td>
<td>4</td>
<td>Progressively increase image size by <code>increase_by</code>, or minimum increase per upsizing epoch</td>
</tr>
<tr class="odd">
<td>increase_mode</td>
<td>IncreaseMode</td>
<td>IncreaseMode.Batch</td>
<td>Increase image size anytime during training or only before an epoch starts</td>
</tr>
<tr class="even">
<td>resize_mode</td>
<td>str</td>
<td>bilinear</td>
<td>PyTorch interpolate mode string for upsizing. Resets to existing fastai DataLoader mode at <code>final_size</code></td>
</tr>
<tr class="odd">
<td>resize_valid</td>
<td>bool</td>
<td>True</td>
<td>Apply progressive resizing to valid dataset</td>
</tr>
<tr class="even">
<td>final_size</td>
<td>tuple[int, int] | None</td>
<td>None</td>
<td>Final image size. Set if using a non-fastai DataLoaders, automatically detected from fastai DataLoader with batch_tfms</td>
</tr>
<tr class="odd">
<td>add_resize</td>
<td>bool</td>
<td>False</td>
<td>Add a separate resize step. Use for non-fastai DataLoaders or fastai DataLoader without batch_tfms</td>
</tr>
<tr class="even">
<td>resize_targ</td>
<td>bool</td>
<td>False</td>
<td>Applies the separate resize step to targets</td>
</tr>
<tr class="odd">
<td>preallocate_bs</td>
<td>int | None</td>
<td>None</td>
<td>Preallocation batch size. Set if the valid DataLoader has a larger batch size than the train DataLoader.</td>
</tr>
<tr class="even">
<td>preallocate</td>
<td>bool</td>
<td>True</td>
<td>Preallocate GPU memory with full size image. Can mitigate memory allocation slowdowns during training. If False set <code>final_size</code>.</td>
</tr>
<tr class="odd">
<td>empty_cache</td>
<td>bool</td>
<td>False</td>
<td>Call <code>torch.cuda.empty_cache()</code> before a resizing epoch. May prevent Cuda &amp; Magma errors. Don’t use with multiple GPUs</td>
</tr>
<tr class="even">
<td>verbose</td>
<td>bool</td>
<td>True</td>
<td>Print a summary of the progressive resizing schedule</td>
</tr>
</tbody>
</table>
<p>Progressive Resizing initially trains on downsampled images then gradually increases the image size over to the full size for the remainder of training.</p>
<p>This can significantly reduce training time at the possible expense of lower model performance. However, Progressive Resizing allows training on more samples within the same compute budget, usually leading to increased performance.</p>
<p>The model must be capable of variable image sizes.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip: Increase DataLoader Throughput
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><code>ProgressiveResize</code> should increase GPU throughput which may cause other parts of the training pipeline become a bottleneck. You can test for a DataLoader bottleneck using a fastxtend <a href="callback.profiler.html">profiler</a>.</p>
<p>An easy way to increase fastai’s DataLoader throughput is by <a href="https://docs.fast.ai/dev/performance.html#pillow-simd">replacing Pillow with Pillow-SIMD</a>.</p>
<p>For best performance, use fastxtend’s <a href="ffcv.tutorial.html">FFCV Loader</a>.</p>
</div>
</div>
</div>
<p>When testing Composer’s <a href="https://docs.mosaicml.com/en/stable/method_cards/progressive_resizing.html">Progressive Resizing</a> callback MosiacML <a href="https://docs.mosaicml.com/en/stable/method_cards/progressive_resizing.html#technical-details">found</a>:</p>
<blockquote class="blockquote">
<p>In our experiments, Progressive Resizing improves the attainable tradeoffs between training speed and the final quality of the trained model. In some cases, it leads to slightly lower quality than the original model for the same number of training steps. However, Progressive Resizing increases training speed so much (via improved throughput during the early part of training) that it is possible to train for more steps, recover accuracy, and still complete training in less time.</p>
</blockquote>
<p><a href="https://fastxtend.benjaminwarner.dev/callback.progresize.html#progressiveresize"><code>ProgressiveResize</code></a> modifies the fastai batch augmentation pipeline by changing the <code>batch_tfms</code> size during training. Specifically, it modifies <code>AffineCoordTfm</code> size, which is set by any rotate, warp, or resize batch augmentation, and/or <code>RandomResizedCropGPU</code> size. This modification prevents unnecessarily resizing images a second time on the GPU, speeding up the process. If there are no <code>batch_tfms</code> or if training without a fastai DataLoader or fastxtend <a href="ffcv.loader.html">Loader</a>, set <code>add_resize=True</code> to resize the batch on the GPU using PyTorch’s <code>interpolate</code>.</p>
<p>Progressive Resizing works best when the resize steps are spread out over a significant portion of the dataset.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip: Progressive Resizing &amp; Small Datasets
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>If training small datasets with <code>ProgressiveResize</code>, such as <a href="https://github.com/fastai/imagenette">Imagenette</a>, scale the batch mode increase amount to be larger than the default of 4 by setting <code>increase_by</code> to a custom value.</p>
<p>In the <a href="#example">example section</a>, <code>increase_by=16</code> gives good results for training Imagenette for 20-25 epochs.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important: Preallocating GPU Memory Uses a Validation Batch
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Before training starts, <code>ProgressiveResize</code> performs a <a href="https://pytorch.org/tutorials/recipes/recipes/tuning_guide.html#pre-allocate-memory-in-case-of-variable-input-length">dry run to preallocate GPU memory</a> required for training on full images. This can prevent stuttering during training due to memory allocation.</p>
<p>If the validation batch size is larger than the training batch size, set <code>preallocate_bs</code> to the training batch size so <code>ProgressiveResize</code> will preallocate the correct amount of memory.</p>
<p>Validation images must be the same size as the full training image size.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note: Logging Image Size
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><code>ProgressiveResize</code> supports logging to Weights &amp; Biases and TensorBoard via the <a href="https://fastxtend.benjaminwarner.dev/callback.utils.html#logdispatch"><code>LogDispatch</code></a> callback. If either the <a href="https://docs.fast.ai/callback.wandb.html#wandbcallback"><code>fastai.callback.wandb.WandbCallback</code></a> or <a href="https://docs.fast.ai/callback.tensorboard.html#tensorboardcallback"><code>fastai.callback.tensorboard.TensorBoardCallback</code></a> are added to <code>Learner</code>, <code>ProgressiveResize</code> will automatically log the current image size as <code>progressive_resize_size</code>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note: Older Versions of PyTorch
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If training on older versions of PyTorch with <code>ProgressiveResize</code> results in CUDA or Magma errors, try setting <code>increase_mode=IncreaseMode.Epoch</code> and <code>empty_cache=True</code>.</p>
<p>This will upsize once per epoch and call <code>torch.cuda.empty_cache()</code> before a resizing epoch. <code>empty_cache=True</code> may interfere with training multiple models on multi-GPU systems.</p>
</div>
</div>
</div>
<p><a href="https://fastxtend.benjaminwarner.dev/callback.progresize.html#progressiveresize"><code>ProgressiveResize</code></a> is fully compatible with <a href="https://fastxtend.benjaminwarner.dev/callback.cutmixup.html#cutmixupaugment"><code>CutMixUpAugment</code></a>.</p>
</section>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">Example</h2>
<p>In this example<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, a <a href="https://fastxtend.benjaminwarner.dev/vision.models.xresnet.html#xresnext50"><code>xresnext50</code></a> is trained for 20 &amp; 25 epochs on <a href="https://github.com/fastai/imagenette">Imagenette</a> at an image size of 224 pixels. Due to the short training run and small dataset, <a href="https://fastxtend.benjaminwarner.dev/callback.progresize.html#progressiveresize"><code>ProgressiveResize</code></a> in batch mode is set to <code>increase_by=16</code>.</p>
<p><code>ProgressiveResize</code> yields significant training time savings compared to training at full size. At a normalized compute budget of roughly 6.5 minutes, Progressive Resizing results with 92.7% accuracy compared to 92% accuracy with full sized training.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Mode</th>
<th style="text-align: center;">Epochs</th>
<th style="text-align: center;">Time (Mins)</th>
<th style="text-align: center;">Accuracy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Full Size</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">6.5</td>
<td style="text-align: center;">92.0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Progressive Batch</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">5.2</td>
<td style="text-align: center;">92.3%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Progressive Epoch</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">5.2</td>
<td style="text-align: center;">91.8%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Progressive Batch</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">6.5</td>
<td style="text-align: center;">92.7%</td>
</tr>
</tbody>
</table>
<p>Due to the regularization effect of training on different sized images, Progressive Resizing with <code>increase_by=16</code> outperforms full sized training by 0.3% in 25 percent less timeon the same number of epochs<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> .</p>
<section id="progressive-resizing" class="level3">
<h3 class="anchored" data-anchor-id="progressive-resizing">Progressive Resizing</h3>
<p>There are two Progressive Resizing <a href="https://fastxtend.benjaminwarner.dev/callback.progresize.html#increasemode"><code>IncreaseMode</code></a> types:</p>
<ul>
<li><code>increase_mode=IncreaseMode.Batch</code></li>
<li><code>increase_mode=IncreaseMode.Epoch</code></li>
</ul>
<p>this example will show both.</p>
<section id="batch-resizing" class="level4">
<h4 class="anchored" data-anchor-id="batch-resizing">Batch Resizing</h4>
<p><a href="https://fastxtend.benjaminwarner.dev/callback.progresize.html#progressiveresize"><code>ProgressiveResize</code></a> with the default <code>increase_mode=IncreaseMode.Batch</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>imagenette <span class="op">=</span> untar_data(URLs.IMAGENETTE_320)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> less_random():</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    dblock <span class="op">=</span> DataBlock(blocks<span class="op">=</span>(ImageBlock, CategoryBlock),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                       splitter<span class="op">=</span>GrandparentSplitter(valid_name<span class="op">=</span><span class="st">'val'</span>),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                       get_items<span class="op">=</span>get_image_files, get_y<span class="op">=</span>parent_label,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                       item_tfms<span class="op">=</span>Resize(<span class="dv">224</span>),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                       batch_tfms<span class="op">=</span>[<span class="op">*</span>aug_transforms(),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                                   Normalize.from_stats(<span class="op">*</span>imagenet_stats)])</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    dls <span class="op">=</span> dblock.dataloaders(imagenette, bs<span class="op">=</span><span class="dv">64</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                             num_workers<span class="op">=</span>num_cpus(), pin_memory<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    learn <span class="op">=</span> Learner(dls, xresnext50(n_out<span class="op">=</span>dls.c), opt_func<span class="op">=</span>ranger(foreach<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                    loss_func<span class="op">=</span>nn.CrossEntropyLoss(label_smoothing<span class="op">=</span><span class="fl">0.1</span>),</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                    metrics<span class="op">=</span>Accuracy()).to_channelslast()</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> time.perf_counter()</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    learn.fit_flat_cos(<span class="dv">20</span>, <span class="fl">8e-3</span>, cbs<span class="op">=</span>ProgressiveResize(increase_by<span class="op">=</span><span class="dv">16</span>))</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> time.perf_counter() <span class="op">-</span> start</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'Total training time: </span><span class="sc">{</span>scale_time(total)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Progressively increase the initial image size of [112, 112] by 16 pixels every 0.8333 epochs for 7 resizes. 
Starting at epoch 10 and finishing at epoch 15 for a final training size of [224, 224].
Total training time: 311.8 s</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.670977</td>
<td>1.883999</td>
<td>0.454268</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.403678</td>
<td>1.226364</td>
<td>0.710573</td>
<td>00:13</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.251599</td>
<td>1.446574</td>
<td>0.626497</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>3</td>
<td>1.136825</td>
<td>1.079901</td>
<td>0.768662</td>
<td>00:13</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1.062239</td>
<td>1.250891</td>
<td>0.718981</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>5</td>
<td>1.006945</td>
<td>0.955187</td>
<td>0.820127</td>
<td>00:13</td>
</tr>
<tr class="odd">
<td>6</td>
<td>0.957047</td>
<td>1.238453</td>
<td>0.703439</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>7</td>
<td>0.910177</td>
<td>0.900485</td>
<td>0.842548</td>
<td>00:13</td>
</tr>
<tr class="odd">
<td>8</td>
<td>0.889880</td>
<td>0.963289</td>
<td>0.816560</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>9</td>
<td>0.860453</td>
<td>0.881689</td>
<td>0.849936</td>
<td>00:13</td>
</tr>
<tr class="odd">
<td>10</td>
<td>0.839035</td>
<td>0.952776</td>
<td>0.828535</td>
<td>00:14</td>
</tr>
<tr class="even">
<td>11</td>
<td>0.815573</td>
<td>0.857969</td>
<td>0.863439</td>
<td>00:14</td>
</tr>
<tr class="odd">
<td>12</td>
<td>0.791430</td>
<td>0.863359</td>
<td>0.858089</td>
<td>00:15</td>
</tr>
<tr class="even">
<td>13</td>
<td>0.770404</td>
<td>0.786469</td>
<td>0.887898</td>
<td>00:16</td>
</tr>
<tr class="odd">
<td>14</td>
<td>0.772790</td>
<td>0.848503</td>
<td>0.866242</td>
<td>00:17</td>
</tr>
<tr class="even">
<td>15</td>
<td>0.745845</td>
<td>0.774377</td>
<td>0.890955</td>
<td>00:19</td>
</tr>
<tr class="odd">
<td>16</td>
<td>0.704179</td>
<td>0.769880</td>
<td>0.891974</td>
<td>00:19</td>
</tr>
<tr class="even">
<td>17</td>
<td>0.640226</td>
<td>0.731178</td>
<td>0.914395</td>
<td>00:19</td>
</tr>
<tr class="odd">
<td>18</td>
<td>0.604006</td>
<td>0.706209</td>
<td>0.920764</td>
<td>00:19</td>
</tr>
<tr class="even">
<td>19</td>
<td>0.584977</td>
<td>0.698062</td>
<td>0.922548</td>
<td>00:19</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="epoch-resizing" class="level4">
<h4 class="anchored" data-anchor-id="epoch-resizing">Epoch Resizing</h4>
<p><a href="https://fastxtend.benjaminwarner.dev/callback.progresize.html#progressiveresize"><code>ProgressiveResize</code></a> with <code>increase_mode=IncreaseMode.Epoch</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>imagenette <span class="op">=</span> untar_data(URLs.IMAGENETTE_320)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> less_random():</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    dblock <span class="op">=</span> DataBlock(blocks<span class="op">=</span>(ImageBlock, CategoryBlock),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                       splitter<span class="op">=</span>GrandparentSplitter(valid_name<span class="op">=</span><span class="st">'val'</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                       get_items<span class="op">=</span>get_image_files, get_y<span class="op">=</span>parent_label,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                       item_tfms<span class="op">=</span>Resize(<span class="dv">224</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                       batch_tfms<span class="op">=</span>[<span class="op">*</span>aug_transforms(),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                                   Normalize.from_stats(<span class="op">*</span>imagenet_stats)])</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    dls <span class="op">=</span> dblock.dataloaders(imagenette, bs<span class="op">=</span><span class="dv">64</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                             num_workers<span class="op">=</span>num_cpus(), pin_memory<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    learn <span class="op">=</span> Learner(dls, xresnext50(n_out<span class="op">=</span>dls.c), opt_func<span class="op">=</span>ranger(foreach<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                    loss_func<span class="op">=</span>nn.CrossEntropyLoss(label_smoothing<span class="op">=</span><span class="fl">0.1</span>),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                    metrics<span class="op">=</span>Accuracy()).to_channelslast()</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> time.perf_counter()</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    learn.fit_flat_cos(<span class="dv">20</span>, <span class="fl">8e-3</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                       cbs<span class="op">=</span>ProgressiveResize(increase_mode<span class="op">=</span>IncreaseMode.Epoch))</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> time.perf_counter() <span class="op">-</span> start</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'Total training time: </span><span class="sc">{</span>scale_time(total)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Progressively increase the initial image size of [112, 112] by 28 pixels every 1 epoch for 4 resizes.
Starting at epoch 12 and finishing at epoch 15 for a final training size of [224, 224].
Total training time: 309.3 s</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.670977</td>
<td>1.883999</td>
<td>0.454268</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.403678</td>
<td>1.226364</td>
<td>0.710573</td>
<td>00:13</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.251599</td>
<td>1.446574</td>
<td>0.626497</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>3</td>
<td>1.136825</td>
<td>1.079901</td>
<td>0.768662</td>
<td>00:13</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1.062239</td>
<td>1.250891</td>
<td>0.718981</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>5</td>
<td>1.006945</td>
<td>0.955187</td>
<td>0.820127</td>
<td>00:13</td>
</tr>
<tr class="odd">
<td>6</td>
<td>0.957047</td>
<td>1.238453</td>
<td>0.703439</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>7</td>
<td>0.910177</td>
<td>0.900485</td>
<td>0.842548</td>
<td>00:13</td>
</tr>
<tr class="odd">
<td>8</td>
<td>0.889880</td>
<td>0.963289</td>
<td>0.816560</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>9</td>
<td>0.860453</td>
<td>0.881689</td>
<td>0.849936</td>
<td>00:14</td>
</tr>
<tr class="odd">
<td>10</td>
<td>0.839285</td>
<td>0.916867</td>
<td>0.835159</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>11</td>
<td>0.817720</td>
<td>0.837916</td>
<td>0.866242</td>
<td>00:13</td>
</tr>
<tr class="odd">
<td>12</td>
<td>0.792356</td>
<td>0.844864</td>
<td>0.869045</td>
<td>00:14</td>
</tr>
<tr class="even">
<td>13</td>
<td>0.780980</td>
<td>0.811714</td>
<td>0.878471</td>
<td>00:15</td>
</tr>
<tr class="odd">
<td>14</td>
<td>0.780541</td>
<td>0.870851</td>
<td>0.853758</td>
<td>00:17</td>
</tr>
<tr class="even">
<td>15</td>
<td>0.766215</td>
<td>0.788430</td>
<td>0.888153</td>
<td>00:19</td>
</tr>
<tr class="odd">
<td>16</td>
<td>0.709244</td>
<td>0.788267</td>
<td>0.887134</td>
<td>00:19</td>
</tr>
<tr class="even">
<td>17</td>
<td>0.649643</td>
<td>0.732368</td>
<td>0.915159</td>
<td>00:19</td>
</tr>
<tr class="odd">
<td>18</td>
<td>0.611495</td>
<td>0.717171</td>
<td>0.915414</td>
<td>00:19</td>
</tr>
<tr class="even">
<td>19</td>
<td>0.590308</td>
<td>0.708605</td>
<td>0.918471</td>
<td>00:19</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="normal-training" class="level3">
<h3 class="anchored" data-anchor-id="normal-training">Normal Training</h3>
<p>fastai model training without Progressive Resizing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>imagenette <span class="op">=</span> untar_data(URLs.IMAGENETTE_320)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> less_random():</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    dblock <span class="op">=</span> DataBlock(blocks<span class="op">=</span>(ImageBlock, CategoryBlock),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                       splitter<span class="op">=</span>GrandparentSplitter(valid_name<span class="op">=</span><span class="st">'val'</span>),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                       get_items<span class="op">=</span>get_image_files, get_y<span class="op">=</span>parent_label,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                       item_tfms<span class="op">=</span>Resize(<span class="dv">224</span>),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                       batch_tfms<span class="op">=</span>[<span class="op">*</span>aug_transforms(),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                                   Normalize.from_stats(<span class="op">*</span>imagenet_stats)])</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    dls <span class="op">=</span> dblock.dataloaders(imagenette, bs<span class="op">=</span><span class="dv">64</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                             num_workers<span class="op">=</span>num_cpus(), pin_memory<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    learn <span class="op">=</span> Learner(dls, xresnext50(n_out<span class="op">=</span>dls.c), opt_func<span class="op">=</span>ranger(foreach<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                    loss_func<span class="op">=</span>nn.CrossEntropyLoss(label_smoothing<span class="op">=</span><span class="fl">0.1</span>),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                    metrics<span class="op">=</span>Accuracy()).to_channelslast()</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> time.perf_counter()</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    learn.fit_flat_cos(<span class="dv">20</span>, <span class="fl">8e-3</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> time.perf_counter() <span class="op">-</span> start</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'Total training time: </span><span class="sc">{</span>scale_time(total)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.693837</td>
<td>1.660484</td>
<td>0.539873</td>
<td>00:19</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.425402</td>
<td>1.288508</td>
<td>0.682548</td>
<td>00:19</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.249855</td>
<td>1.231204</td>
<td>0.726879</td>
<td>00:19</td>
</tr>
<tr class="even">
<td>3</td>
<td>1.107746</td>
<td>1.027718</td>
<td>0.794904</td>
<td>00:19</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1.046856</td>
<td>1.113385</td>
<td>0.782420</td>
<td>00:19</td>
</tr>
<tr class="even">
<td>5</td>
<td>0.974740</td>
<td>1.055205</td>
<td>0.800255</td>
<td>00:19</td>
</tr>
<tr class="odd">
<td>6</td>
<td>0.933220</td>
<td>1.195850</td>
<td>0.756688</td>
<td>00:19</td>
</tr>
<tr class="even">
<td>7</td>
<td>0.880307</td>
<td>0.905752</td>
<td>0.845096</td>
<td>00:19</td>
</tr>
<tr class="odd">
<td>8</td>
<td>0.854195</td>
<td>1.113956</td>
<td>0.772229</td>
<td>00:19</td>
</tr>
<tr class="even">
<td>9</td>
<td>0.839854</td>
<td>0.838828</td>
<td>0.868790</td>
<td>00:19</td>
</tr>
<tr class="odd">
<td>10</td>
<td>0.815095</td>
<td>0.868798</td>
<td>0.861146</td>
<td>00:19</td>
</tr>
<tr class="even">
<td>11</td>
<td>0.786958</td>
<td>0.839955</td>
<td>0.867771</td>
<td>00:19</td>
</tr>
<tr class="odd">
<td>12</td>
<td>0.763221</td>
<td>0.884713</td>
<td>0.853758</td>
<td>00:19</td>
</tr>
<tr class="even">
<td>13</td>
<td>0.751375</td>
<td>0.780010</td>
<td>0.890955</td>
<td>00:19</td>
</tr>
<tr class="odd">
<td>14</td>
<td>0.740009</td>
<td>0.835440</td>
<td>0.872102</td>
<td>00:19</td>
</tr>
<tr class="even">
<td>15</td>
<td>0.710022</td>
<td>0.793270</td>
<td>0.888408</td>
<td>00:19</td>
</tr>
<tr class="odd">
<td>16</td>
<td>0.683471</td>
<td>0.743397</td>
<td>0.909809</td>
<td>00:19</td>
</tr>
<tr class="even">
<td>17</td>
<td>0.630301</td>
<td>0.735851</td>
<td>0.910828</td>
<td>00:19</td>
</tr>
<tr class="odd">
<td>18</td>
<td>0.596394</td>
<td>0.715150</td>
<td>0.916688</td>
<td>00:19</td>
</tr>
<tr class="even">
<td>19</td>
<td>0.577142</td>
<td>0.701738</td>
<td>0.918981</td>
<td>00:19</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Total training time: 387.2 s</code></pre>
</div>
</div>
</section>
<section id="progressive-resizing-with-normalized-compute-budget" class="level3">
<h3 class="anchored" data-anchor-id="progressive-resizing-with-normalized-compute-budget">Progressive Resizing with Normalized Compute Budget</h3>
<p><a href="https://fastxtend.benjaminwarner.dev/callback.progresize.html#progressiveresize"><code>ProgressiveResize</code></a> with the default <code>increase_mode=IncreaseMode.Batch</code> trained to match the <a href="#normal-training">Normal Training’s</a> compute.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>imagenette <span class="op">=</span> untar_data(URLs.IMAGENETTE_320)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> less_random():</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    dblock <span class="op">=</span> DataBlock(blocks<span class="op">=</span>(ImageBlock, CategoryBlock),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                       splitter<span class="op">=</span>GrandparentSplitter(valid_name<span class="op">=</span><span class="st">'val'</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                       get_items<span class="op">=</span>get_image_files, get_y<span class="op">=</span>parent_label,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                       item_tfms<span class="op">=</span>Resize(<span class="dv">224</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                       batch_tfms<span class="op">=</span>[<span class="op">*</span>aug_transforms(),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                                   Normalize.from_stats(<span class="op">*</span>imagenet_stats)])</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    dls <span class="op">=</span> dblock.dataloaders(imagenette, bs<span class="op">=</span><span class="dv">64</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                             num_workers<span class="op">=</span>num_cpus(), pin_memory<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    learn <span class="op">=</span> Learner(dls, xresnext50(n_out<span class="op">=</span>dls.c), opt_func<span class="op">=</span>ranger(foreach<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>                    loss_func<span class="op">=</span>nn.CrossEntropyLoss(label_smoothing<span class="op">=</span><span class="fl">0.1</span>),</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>                    metrics<span class="op">=</span>Accuracy()).to_channelslast()</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> time.perf_counter()</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    learn.fit_flat_cos(<span class="dv">25</span>, <span class="fl">8e-3</span>, cbs<span class="op">=</span>ProgressiveResize(increase_by<span class="op">=</span><span class="dv">16</span>))</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> time.perf_counter() <span class="op">-</span> start</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'Total training time: </span><span class="sc">{</span>scale_time(total)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Progressively increase the initial image size of [112, 112] by 16 pixels every 1.042 epochs for 7 resizes. 
Starting at epoch 12.5 and finishing at epoch 18.75 for a final training size of [224, 224].
Total training time: 390.5 s</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.670977</td>
<td>1.883999</td>
<td>0.454268</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.403678</td>
<td>1.226364</td>
<td>0.710573</td>
<td>00:13</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.251599</td>
<td>1.446574</td>
<td>0.626497</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>3</td>
<td>1.136825</td>
<td>1.079901</td>
<td>0.768662</td>
<td>00:13</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1.062239</td>
<td>1.250891</td>
<td>0.718981</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>5</td>
<td>1.006945</td>
<td>0.955187</td>
<td>0.820127</td>
<td>00:13</td>
</tr>
<tr class="odd">
<td>6</td>
<td>0.957047</td>
<td>1.238453</td>
<td>0.703439</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>7</td>
<td>0.910177</td>
<td>0.900485</td>
<td>0.842548</td>
<td>00:13</td>
</tr>
<tr class="odd">
<td>8</td>
<td>0.889880</td>
<td>0.963289</td>
<td>0.816560</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>9</td>
<td>0.860453</td>
<td>0.881689</td>
<td>0.849936</td>
<td>00:13</td>
</tr>
<tr class="odd">
<td>10</td>
<td>0.839285</td>
<td>0.916867</td>
<td>0.835159</td>
<td>00:13</td>
</tr>
<tr class="even">
<td>11</td>
<td>0.817720</td>
<td>0.837916</td>
<td>0.866242</td>
<td>00:13</td>
</tr>
<tr class="odd">
<td>12</td>
<td>0.806093</td>
<td>0.869887</td>
<td>0.850701</td>
<td>00:14</td>
</tr>
<tr class="even">
<td>13</td>
<td>0.780977</td>
<td>0.805412</td>
<td>0.877962</td>
<td>00:14</td>
</tr>
<tr class="odd">
<td>14</td>
<td>0.766974</td>
<td>0.899283</td>
<td>0.839490</td>
<td>00:14</td>
</tr>
<tr class="even">
<td>15</td>
<td>0.757296</td>
<td>0.811422</td>
<td>0.878726</td>
<td>00:15</td>
</tr>
<tr class="odd">
<td>16</td>
<td>0.736302</td>
<td>0.855174</td>
<td>0.853758</td>
<td>00:15</td>
</tr>
<tr class="even">
<td>17</td>
<td>0.723357</td>
<td>0.769306</td>
<td>0.901401</td>
<td>00:16</td>
</tr>
<tr class="odd">
<td>18</td>
<td>0.714021</td>
<td>0.765733</td>
<td>0.895287</td>
<td>00:18</td>
</tr>
<tr class="even">
<td>19</td>
<td>0.697444</td>
<td>0.736115</td>
<td>0.911847</td>
<td>00:19</td>
</tr>
<tr class="odd">
<td>20</td>
<td>0.663537</td>
<td>0.790711</td>
<td>0.881783</td>
<td>00:19</td>
</tr>
<tr class="even">
<td>21</td>
<td>0.617896</td>
<td>0.712593</td>
<td>0.919745</td>
<td>00:19</td>
</tr>
<tr class="odd">
<td>22</td>
<td>0.583567</td>
<td>0.710089</td>
<td>0.918471</td>
<td>00:19</td>
</tr>
<tr class="even">
<td>23</td>
<td>0.562689</td>
<td>0.685103</td>
<td>0.927643</td>
<td>00:19</td>
</tr>
<tr class="odd">
<td>24</td>
<td>0.551753</td>
<td>0.686037</td>
<td>0.926879</td>
<td>00:19</td>
</tr>
</tbody>
</table>
</div>
</div>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>All models are trained on a GeForce 3080 Ti using PyTorch 1.13.1 and Cuda 11.7. Results may differ with other datasets, hardware, and across runs.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>While Progressive Resizing can sometimes outperform full sized trained model in the same number of epochs, it is just as likely to perform worse, depending on setup.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/fastxtend\.benjaminwarner\.dev\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright © 2023 Benjamin Warner, MIT License</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/warner-benjamin/fastxtend/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/benjamin_warner">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>